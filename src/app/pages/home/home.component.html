<h1>Todo App</h1>

<div>
  <input
    type="text"
    [value]="updateTask()?.title ?? newTaskText()"
    (input)="handleNewTaskTextOnChange($event)"
    (keydown)="handleNewTaskTextOnKeyDown($event)"
    [placeholder]="updateTask() ? 'update current task...' : 'Add a new task...'"
  />
  @if(updateTask()) {
  <button (click)="handleUpdateEditedTask()">Update Task</button>
  <button (click)="updateTask.set(undefined)">Cancel</button>
  } @else {
  <button (click)="handleAddTask()">Add Task</button>
  }
</div>

<br />

<div>
  <span>Total Tasks = {{ total() }}</span>
</div>
<div>
  <span>Completed Tasks = {{ completedCount() }}</span>
</div>

<br />

<table class="task-table">
  <thead>
    <tr>
      <th>ID</th>
      <th>Title</th>
      <th>Completed?</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    @for ( task of taskList(); track task.id; let i = $index) {
    <tr
      app-task
      [task]="task"
      [class.selected]="task.id === updateTask()?.id"
      (markComplete)="handleToggleTaskComplete(task.id)"
      (editTask)="updateTask.set(task)"
      (deleteTask)="handleDeleteTask(task.id)"
    ></tr>
    } @empty {
    <tr>
      <td colspan="4" style="text-align: center; padding-block: 4rem">There are no items.</td>
    </tr>
    }
  </tbody>
</table>
