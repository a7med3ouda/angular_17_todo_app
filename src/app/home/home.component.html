<h1>Todo App</h1>

<div>
  <input
    type="text"
    [value]="updateTodo()?.title ?? newTodoText()"
    (input)="handleNewTodoTextOnChange($event)"
    (keydown)="handleNewTodoTextOnKeyDown($event)"
    [placeholder]="
      updateTodo() ? 'update current todo...' : 'Add a new todo...'
    "
  />
  @if(updateTodo()) {
  <button (click)="handleUpdateEditedTodo()">Update Todo</button>
  <button (click)="updateTodo.set(undefined)">Cancel</button>
  } @else {
  <button (click)="handleAddTodo()">Add Todo</button>
  }
</div>

<br />

<div>
  <span>Total Todo = {{ total() }}</span>
</div>

<br />

<table class="todo-table">
  <thead>
    <tr>
      <th>ID</th>
      <th>Title</th>
      <th>Completed?</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    @for ( todo of todoList(); track todo.id; let i = $index) {
    <tr [class.selected]="todo.id === updateTodo()?.id">
      <td>{{ todo.id }}</td>
      <td>{{ todo.title }}</td>
      <td>
        <input
          type="checkbox"
          [id]="todo.id"
          [checked]="todo.completed"
          (click)="handleToggleTodoComplete(todo.id)"
        />
      </td>
      <td>
        <button (click)="updateTodo.set(todo)">Edit</button>
        <button (click)="handleDeleteTodo(todo.id)">Delete</button>
      </td>
    </tr>
    } @empty {
    <tr>
      <td colspan="4" style="text-align: center; padding-block: 4rem">
        There are no items.
      </td>
    </tr>
    }
  </tbody>
</table>
